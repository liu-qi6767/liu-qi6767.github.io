<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éŸ³ä¹ç«™-ç®¡ç†å‘˜åå°ï¼ˆå¸¦æ­Œè¯ç®¡ç†ï¼‰</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box;}
        body{background:#f5f5f5;padding:20px;font-family:å¾®è½¯é›…é»‘;}
        .admin-box{max-width:800px;margin:0 auto;background:#fff;padding:30px;border-radius:10px;box-shadow:0 0 10px rgba(0,0,0,0.1);}
        .title{text-align:center;font-size:24px;color:#333;margin-bottom:30px;border-bottom:2px solid #FF6700;padding-bottom:10px;}
        .form-item{margin:20px 0;}
        .form-item label{display:block;font-size:16px;color:#333;margin-bottom:8px;}
        .form-item input, select{width:100%;padding:12px;border:1px solid #ddd;border-radius:6px;font-size:16px;}
        .btn{width:100%;padding:15px;background:#FF6700;color:#fff;border:none;border-radius:6px;font-size:18px;cursor:pointer;margin:10px 0;}
        .btn:hover{background:#e55a00;}
        .music-list{margin-top:30px;}
        .music-list h3{color:#333;margin-bottom:15px;}
        .music-item{padding:10px;border-bottom:1px solid #eee;display:flex;justify-content:space-between;align-items:center;}
        .music-item span{font-size:14px;color:#666;}
        .del-btn{color:#ff4444;cursor:pointer;}
        .tips{color:#999;font-size:12px;margin-top:5px;}
    </style>
</head>
<body>
    <div class="admin-box">
        <h1 class="title">ğŸµ éŸ³ä¹ç«™-ç®¡ç†å‘˜åå°ï¼ˆæ”¯æŒæ­Œè¯ï¼‰</h1>
        <!-- æ­Œæ›²ä¸Šä¼ è¡¨å• -->
        <div class="form-item">
            <label>æ­Œæ›²åç§°</label>
            <input type="text" id="musicName" placeholder="è¯·è¾“å…¥æ­Œæ›²åç§°">
        </div>
        <div class="form-item">
            <label>æ­Œæ‰‹åç§°</label>
            <input type="text" id="singerName" placeholder="è¯·è¾“å…¥æ­Œæ‰‹åç§°">
        </div>
        <div class="form-item">
            <label>æ­Œæ›²åˆ†ç±»</label>
            <select id="musicType">
                <option value="åŸåˆ›éŸ³ä¹">åŸåˆ›éŸ³ä¹</option>
                <option value="æµè¡ŒéŸ³ä¹">æµè¡ŒéŸ³ä¹</option>
                <option value="è½»éŸ³ä¹">è½»éŸ³ä¹</option>
                <option value="å…¶ä»–">å…¶ä»–</option>
            </select>
        </div>
        <div class="form-item">
            <label>ä¸Šä¼ æ­Œæ›²MP3æ–‡ä»¶</label>
            <input type="file" id="musicFile" accept=".mp3">
        </div>
        <div class="form-item">
            <label>ä¸Šä¼ æ­Œè¯å›¾ç‰‡ï¼ˆæ”¯æŒjpg/pngï¼Œç«–å±é•¿å›¾æœ€ä½³ï¼‰</label>
            <input type="file" id="lyricFile" accept=".jpg,.png">
            <div class="tips">æç¤ºï¼šé€‰å¡«ï¼Œå»ºè®®ä½¿ç”¨ç«–å±é•¿å›¾ï¼ˆå¦‚750x1334pxï¼‰ï¼Œç‚¹å‡»æ’­æ”¾é¡µæ­Œè¯æŒ‰é’®æ˜¾ç¤º</div>
        </div>
        <div class="form-item">
            <label>æ­Œæ›²å°é¢å›¾ç‰‡ï¼ˆå¯é€‰ï¼‰</label>
            <input type="file" id="coverFile" accept=".jpg,.png">
        </div>
        <button class="btn" onclick="addMusic()">âœ… æ·»åŠ æ­Œæ›²åˆ°åº“</button>
        <button class="btn" style="background:#2196F3;" onclick="generateMusicList()">âœ… ç”Ÿæˆæ­Œæ›²åº“+æ›´æ–°å‰ç«¯é¡µé¢</button>
        <button class="btn" style="background:#4CAF50;" onclick="previewSite()">âœ… æœ¬åœ°é¢„è§ˆ</button>

        <!-- å·²æ·»åŠ æ­Œæ›²åˆ—è¡¨ -->
        <div class="music-list">
            <h3>å·²æ·»åŠ çš„æ­Œæ›²åº“</h3>
            <div id="musicListBox"></div>
        </div>
    </div>

    <script>
        let musicDb = [];
        if(localStorage.getItem('musicDb')){
            musicDb = JSON.parse(localStorage.getItem('musicDb'));
            renderMusicList();
        }
        // æ·»åŠ æ­Œæ›²ï¼ˆæ–°å¢lyricå­—æ®µï¼‰
        function addMusic(){
            const name = document.getElementById('musicName').value.trim();
            const singer = document.getElementById('singerName').value.trim();
            const type = document.getElementById('musicType').value;
            const file = document.getElementById('musicFile').files[0];
            if(!name || !singer || !file) {alert('è¯·å¡«å†™å®Œæ•´ä¿¡æ¯å¹¶é€‰æ‹©MP3ï¼');return;}
            
            const musicItem = {
                id: Date.now(),
                name: name,
                singer: singer,
                type: type,
                src: "res/music/" + file.name,  // âœ… æ–°å¢res/music/è·¯å¾„
                cover: document.getElementById('coverFile').files[0] ? document.getElementById('coverFile').files[0].name : 'default.jpg',
                lyric: document.getElementById('lyricFile').files[0] ? document.getElementById('lyricFile').files[0].name : '' // æ–°å¢æ­Œè¯æ–‡ä»¶å
            };
            musicDb.push(musicItem);
            localStorage.setItem('musicDb', JSON.stringify(musicDb));
            renderMusicList();
            alert('âœ… æ·»åŠ æˆåŠŸï¼');
            // æ¸…ç©ºè¡¨å•
            document.getElementById('musicName').value = '';
            document.getElementById('singerName').value = '';
            document.getElementById('musicFile').value = '';
            document.getElementById('lyricFile').value = ''; // æ¸…ç©ºæ­Œè¯
            document.getElementById('coverFile').value = '';
        }
        function renderMusicList(){
            const box = document.getElementById('musicListBox');
            box.innerHTML = '';
            if(musicDb.length === 0){box.innerHTML = '<p style="color:#999;">æš‚æ— æ­Œæ›²</p>';return;}
            musicDb.forEach(item => {
                box.innerHTML += `<div class="music-item">
                    <span>${item.name} - ${item.singer} ${item.lyric ? '(å«æ­Œè¯)' : ''}</span>
                    <span class="del-btn" onclick="delMusic(${item.id})">åˆ é™¤</span>
                </div>`;
            });
        }
        function delMusic(id){
            musicDb = musicDb.filter(item => item.id !== id);
            localStorage.setItem('musicDb', JSON.stringify(musicDb));
            renderMusicList();
        }
        function generateMusicList(){
            if(musicDb.length === 0){alert('æš‚æ— æ­Œæ›²ï¼');return;}
            const jsonStr = JSON.stringify(musicDb, null, 2);
            console.log('âœ… å¤åˆ¶ä»¥ä¸‹å†…å®¹åˆ° js/musicdb.jsonï¼š');
            console.log(jsonStr);
            alert('âœ… ç”ŸæˆæˆåŠŸï¼è¯·å¤åˆ¶æ§åˆ¶å°å†…å®¹åˆ° js/musicdb.json');
        }
        function previewSite(){
            window.open('index.html', '_blank');
        }
    </script>
</body>
</html>